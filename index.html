<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Catch the Hearts üíñ</title>
<style>
  body {
    margin: 0;
    overflow: hidden;
    font-family: Arial, sans-serif;
    transition: background 2s ease;
    background: linear-gradient(270deg, #ffdde1, #ee9ca7);
    background-size: 400% 400%;
    animation: gradientMove 15s ease infinite;
    touch-action: none;
  }
  @keyframes gradientMove {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
  }
  #gameArea { position: relative; width: 100vw; height: 100vh; overflow: hidden; }
  .heart {
    position: absolute;
    font-size: 10vw;
    cursor: pointer;
    animation: fall linear;
    user-select: none;
    padding: 2vw;
    touch-action: manipulation;
  }
  @keyframes fall { from { top: -10vh; } to { top: 100vh; } }

  #scoreBoard { position: absolute; top: 2vh; left: 2vw; font-size: 4vw; color: white; text-shadow: 1px 1px 2px black; }
  #message, .combo, #finalMessage { 
    position: absolute; left: 50%; transform: translateX(-50%); 
    font-size: 6vw; background: rgba(255,255,255,0.8); padding: 2vh 4vw; 
    border-radius: 3vw; display: none; text-align: center; color: #333;
  }

  .combo { font-size: 4vw; color: yellow; font-weight: bold; pointer-events: none; animation: comboAnim 1s ease forwards; }
  @keyframes comboAnim { 0% { opacity:1; transform: translate(-50%, -50%) scale(1);} 100% { opacity:0; transform: translate(-50%, -80%) scale(1.5);} }

  #finalMessage { top: 40%; font-size: 8vw; font-weight: bold; background: rgba(255,255,255,0.95); color: #e91e63; animation: fadeIn 2s ease forwards; }
  @keyframes fadeIn { 0% { opacity:0; transform: translate(-50%,-50%) scale(0.5); } 100% { opacity:1; transform: translate(-50%,-50%) scale(1); } }

  #playAgain { display: none; position: absolute; top: 55%; left:50%; transform: translateX(-50%); padding: 3vw 6vw; font-size: 5vw; border: none; border-radius: 3vw; background:#ff4081; color:white; cursor:pointer; box-shadow:0 4px 10px rgba(0,0,0,0.2); animation: glow 1.5s infinite; }
  #playAgain:hover { background: #e91e63; }
  @keyframes glow { 0% { box-shadow:0 0 5px #ff4081;} 50% { box-shadow:0 0 20px #ff4081;} 100% { box-shadow:0 0 5px #ff4081;} }

  .confetti { position: absolute; width: 2vw; height: 2vw; background: red; opacity:0.9; pointer-events: none; animation: fallConfetti 3s linear forwards; border-radius: 50%; }
  @keyframes fallConfetti { 0% { transform: translateY(0) rotate(0deg); } 100% { transform: translateY(100vh) rotate(360deg); opacity:0; } }
</style>
</head>
<body>
<div id="gameArea"></div>
<div id="scoreBoard">Score: 0</div>
<div id="message"></div>
<div id="finalMessage"></div>
<button id="playAgain">Play Again üîÅ</button>
<audio id="popSound" src="https://www.soundjay.com/button/sounds/button-16.mp3"></audio>

<script>
const gameArea=document.getElementById("gameArea");
const scoreBoard=document.getElementById("scoreBoard");
const messageBox=document.getElementById("message");
const finalMessage=document.getElementById("finalMessage");
const playAgainBtn=document.getElementById("playAgain");
const popSound=document.getElementById("popSound");

let score=0,currentLevel=1,heartInterval=null,lastClickTime=0,gameEnded=false;
const messagesShown = {5:false,10:false,20:false,25:false,30:false,40:false};
const compliments=["üå∏ You‚Äôre Awesome!","üí´ Unstoppable Energy!","üî• Heart Catching Pro!","‚ú® Queen of Hearts!","üåü Game Master Extraordinaire!"];

const heartTypes=[
  {emoji:"‚ù§Ô∏è", points:1},
  {emoji:"üíú", points:2},
  {emoji:"üíõ", points:3},
  {emoji:"üíô", points:2}
];

function isMobile(){ return /Mobi|Android/i.test(navigator.userAgent); }

function createHeart(){
  if(gameEnded) return;

  const heart=document.createElement("div");
  heart.classList.add("heart");

  const type=heartTypes[Math.floor(Math.random()*heartTypes.length)];
  heart.innerText=type.emoji;
  heart.dataset.points=type.points;

  heart.style.left=Math.random()*(window.innerWidth-80)+"px";
  heart.style.animationDuration=(2+Math.random()*3)+"s";
  gameArea.appendChild(heart);

  const hitArea=document.createElement("div");
  hitArea.style.position="absolute";
  hitArea.style.width="12vw"; hitArea.style.height="12vw";
  hitArea.style.left=heart.style.left; hitArea.style.top="0px";
  hitArea.style.background="transparent";
  gameArea.appendChild(hitArea);

  function handleClick(e){
    const now=Date.now();
    let points=parseInt(heart.dataset.points);
    if(now-lastClickTime<1000) points+=2; // combo bonus
    score+=points;
    lastClickTime=now;
    scoreBoard.textContent="Score: "+score;
    createClickConfetti(e.clientX,e.clientY);
    
    popSound.currentTime=0; 
    popSound.play().catch(err=>console.log(err));

    heart.remove(); hitArea.remove(); 
    checkMessages(score); 
    updateBackground(score);
    if(score>=50 && !gameEnded) endGame();
  }

  heart.addEventListener("click", handleClick);
  hitArea.addEventListener("click", handleClick);
  setTimeout(()=>{heart.remove(); hitArea.remove();},5000);
}

function checkMessages(score){
  const messageMap = {
    5: "Gamer reflexes üí™üî•",
    10: "Careful üëÄ don‚Äôt drop the heart‚Ä¶ üòÇ",
    20: "Ok ok Thanos, leave some for the rest üíé",
    25: "Hey‚Ä¶ just so you know, someone made this just for you üíå",
    30: "You win üò§ remind me not to challenge again",
    40: "Almost there! Keep it up! üåü"
  };

  let delay=0;
  for(const key of [5,10,20,25,30,40]){
    if(score >= key && !messagesShown[key]){
      messagesShown[key]=true;
      setTimeout(()=>{
        messageBox.textContent=messageMap[key];
        messageBox.style.display="block";
        if(key===25) createConfetti(); 
        setTimeout(()=>{messageBox.style.display="none";},4000);
      }, delay);
      delay+=1000; // small gap if multiple messages pop
    }
  }
}

function updateBackground(score){
  let newLevel=currentLevel;
  if(score<10) newLevel=1;
  else if(score<20) newLevel=2;
  else if(score<30) newLevel=3;
  else newLevel=4;

  if(newLevel===1) document.body.style.background="linear-gradient(270deg,#ffdde1,#ee9ca7)";
  else if(newLevel===2) document.body.style.background="linear-gradient(270deg,#f6d365,#fda085)";
  else if(newLevel===3) document.body.style.background="linear-gradient(270deg,#a18cd1,#fbc2eb)";
  else document.body.style.background="linear-gradient(270deg,#43cea2,#185a9d)";

  document.body.style.backgroundSize="400% 400%";
  document.body.style.animation="gradientMove 15s ease infinite";

  currentLevel=newLevel;
}

function createClickConfetti(x,y){
  for(let i=0;i<10;i++){
    const conf=document.createElement("div");
    conf.classList.add("confetti");
    conf.style.width=conf.style.height=(3+Math.random()*5)+"vw";
    conf.style.background=`hsl(${Math.random()*360},100%,70%)`;
    conf.style.left=x+"px"; conf.style.top=y+"px";
    conf.style.animationDuration=(0.8+Math.random()*0.7)+"s";
    document.body.appendChild(conf);
    setTimeout(()=>conf.remove(),1000);
  }
}

function createConfetti(){
  for(let i=0;i<50;i++){
    const conf=document.createElement("div");
    conf.classList.add("confetti");
    conf.style.background=`hsl(${Math.random()*360},100%,60%)`;
    conf.style.left=Math.random()*window.innerWidth+"px";
    conf.style.animationDuration=(2+Math.random()*2)+"s";
    document.body.appendChild(conf);
    setTimeout(()=>conf.remove(),3000);
  }
}

function endGame(){
  gameEnded=true;
  clearInterval(heartInterval);
  const randomMsg=compliments[Math.floor(Math.random()*compliments.length)];
  finalMessage.textContent=randomMsg;
  finalMessage.style.display="block";
  playAgainBtn.style.display="block";
  createConfetti();
}

function resetGame(){
  score=0; currentLevel=1; gameEnded=false; lastClickTime=0;
  for(let key in messagesShown) messagesShown[key]=false;
  scoreBoard.textContent="Score: 0";
  finalMessage.style.display="none";
  playAgainBtn.style.display="none";
  document.body.style.background="linear-gradient(270deg,#ffdde1,#ee9ca7)";
  startHearts();
}

function startHearts(){
  clearInterval(heartInterval);
  const interval = isMobile() ? 1200 : 1000;
  heartInterval = setInterval(createHeart, interval);
}

playAgainBtn.addEventListener("click", resetGame);
startHearts();
</script>
</body>
</html>

